<script setup>
import { ref } from "vue";
import { useViewStore } from "../stores/earth";
import { useSimuStore } from "../stores/simulation";
import { useClickStore } from "../stores/click";
import {
  ScreenSpaceEventHandler,
  defined,
  ScreenSpaceEventType,
  Color
  // SceneTransforms,
} from "cesium";
import { onMounted } from "vue";
import { notification } from "ant-design-vue";
import { use } from "echarts/core";
import { CanvasRenderer } from "echarts/renderers";
import { PieChart, LineChart, BarChart } from "echarts/charts";
import { UniversalTransition } from "echarts/features";
import {
  TitleComponent,
  ToolboxComponent,
  TooltipComponent,
  GridComponent,
  LegendComponent,
  DataZoomComponent,
} from "echarts/components";
import { shuiwei, yuliang, qixiang } from "../assets/data/station_data";
import { fore_data, fore_all_data } from "../assets/data/forcastData";
import handleData from "../utils/handleData";
import VChart from "vue-echarts";
import moment from "moment";
import ExcelJs from "exceljs";

use([
  CanvasRenderer,
  PieChart,
  TitleComponent,
  ToolboxComponent,
  TooltipComponent,
  GridComponent,
  LegendComponent,
  DataZoomComponent,
  LineChart,
  UniversalTransition,
  BarChart,
]);

const simuStore = useSimuStore();
const option = ref({
  backgroundColor: '#fff',
  title: {
    padding:20,
            text: "预报结果(入库流量)",
            left:"center",
            textStyle: {
             
              fontFamily:'微软雅黑',
                        color: '#000',
                        fontSize:15,
                    },

          
          },
  //         legend: {
  //           orient: 'vertical',
  //           icon: 'rect',
  //   data: ['观测值','模拟值'],
  //   right: '13%',
  //   top:'0.5%',
  // },
  tooltip: {
    trigger: "axis",
    axisPointer: {
      animation: false,
    },
  },


  toolbox: {
    feature: {
 
      myClose: {
        show: true,
        title: "关闭弹窗",
        icon: "path://M886.528 908.032c-28.096 28.096-73.856 28.096-102.016 0L138.304 261.824c-28.096-28.16-28.16-73.856 0-102.016 28.032-28.16 73.792-28.16 102.08 0l646.144 646.144C914.624 834.24 914.752 879.872 886.528 908.032L886.528 908.032zM885.76 261.504 239.616 907.648c-28.224 28.224-73.92 28.224-102.08 0-28.16-28.096-28.16-73.728 0.064-102.016L783.744 159.552c28.224-28.16 73.984-28.16 102.016-0.064C913.984 187.648 913.856 233.344 885.76 261.504L885.76 261.504z",
        onclick: function () {
         hideInfo();
  
        },
      },
    },
  },
  // axisPointer: {
  //   link: [
  //     {
  //       xAxisIndex: "all",
  //     },
  //   ],
  // },
  dataZoom: [
    {
       id: 'dataZoomX',
      show: true,
      realtime: true,
      start: 30,
      end: 70,
      xAxisIndex: [0, 1],
    },
    {
      type: "inside",
      realtime: true,
      start: 30,
      end: 70,
      xAxisIndex: [0, 1],
    },
  ],
  grid: {
    left: "12%",
    right: "15%",
    bottom: "20%",
  },
  xAxis: {
    // type: "category",
    name:'预报结果(6月30日0时-7月1日0时)',
    nameLocation: "middle",
    nameGap: 90,
    boundaryGap: false,
    axisLine: { onZero: true },
    data: [
    "2023-6-30-00",
    "2023-6-30-01",
    "2023-6-30-02",
    "2023-6-30-03",
    "2023-6-30-04",
    "2023-6-30-05",
    "2023-6-30-06",
    "2023-6-30-07",
    "2023-6-30-08",
    "2023-6-30-09",
    "2023-6-30-10",
    "2023-6-30-11",
    "2023-6-30-12",
    "2023-6-30-13",
    "2023-6-30-14",
    "2023-6-30-15",
    "2023-6-30-16",
    "2023-6-30-17",
    "2023-6-30-18",
    "2023-6-30-19",
    "2023-6-30-20",
    "2023-6-30-21",
    "2023-6-30-22",
    "2023-6-30-23",
    "2023-7-1-00",

],
  },
  yAxis: {
    name: "m³/d",
    nameTextStyle: {
            padding: [20, 0, 10, -45]    // 四个数字分别为上右下左与原位置距离
        },
    type: "value",

    max: 1600,
    splitNumber : 10,

  },

  series:[
    {
    name: "模拟值",
    type: "line",
    lineStyle : {
                    color : '#f28500',
                  //  width : 4,
                    type : 'solid',
                },
                itemStyle : {
                    color : '#f28500'
                },

   /*  symbolSize: 18, */
    // prettier-ignore
    data: [0,
0.003616609,
0.021699656,
0.036166093,
0.057865749,
0.055365697,
0.690268698,
5.788750222,
36.056161207,
190.371027776,
571.087939042,
1043.221359556,
1449.583628953,
896.162717649,
793.693873891,
710.237674038,
566.721610506,
538.220312698,
518.505897704,
462.740504392,
428.947844119,
408.148709674,
344.754088886,
277.598254586,
233.247445984,
],
  },
//   {
//     name: "观测值",
//     type: "line",
//    /*  symbolSize: 18, */
//     // prettier-ignore
//     lineStyle : {
                   
//                    // width : 4,
//                     type : 'solid',
//                 },
//     data: [47.9921,
// 49.10512,
// 58.58,
// 54.89,
// 50.1,
// 46.6,
// 43.55,
// 44.56,
// 99.4,
// 120.3,
// 565.4,
// 1073,
// 1261,
// 880,
// 631,
// 471,
// 392,
// 385,
// 319,
// 277,
// 301.8,
// 197,
// 233.45,
// 204.4,
// 187.5,

// ],
//   },
  
] ,

});
const hideInfo =()=>{

  simuStore.forecastpicture.isShow =false;

       

}

const data412=ref([
   "2023-4-12-00",
    "2023-4-12-01",
    "2023-4-12-02",
    "2023-4-12-03",
    "2023-4-12-04",
    "2023-4-12-05",
    "2023-4-12-06",
    "2023-4-12-07",
    "2023-4-12-08",
    "2023-4-12-09",
    "2023-4-12-10",
       "2023-4-12-11",
    "2023-4-12-12",
    "2023-4-12-13",
    "2023-4-12-14",
    "2023-4-12-15",
    "2023-4-12-16",
    "2023-4-12-17",
    "2023-4-12-18",
    "2023-4-12-19",
    "2023-4-12-20",
    "2023-4-12-21",
   "2023-4-12-22",
    "2023-4-12-23",
    "2023-4-13-00",
    "2023-4-13-01",
   "2023-4-13-02",
    "2023-4-13-03",
       "2023-4-13-04",
    "2023-4-13-05",
   "2023-4-13-06",
    "2023-4-13-07",
      "2023-4-13-08",
   "2023-4-13-09",
    "2023-4-13-10",
])
const data429=ref([ 
   "2023-4-29-00",
     "2023-4-29-01",
      "2023-4-29-02",
      "2023-4-29-03",
        "2023-4-29-04",
      "2023-4-29-05",
      "2023-4-29-06",
      "2023-4-29-07",
        "2023-4-29-08",
      "2023-4-29-09",
      "2023-4-29-10",
  "2023-4-29-11",
    "2023-4-29-12",
    "2023-4-29-13",
    "2023-4-29-14",
    "2023-4-29-15",
    "2023-4-29-16",
    "2023-4-29-17",
    "2023-4-29-18",
    "2023-4-29-19",
    "2023-4-29-20",
    "2023-4-29-21",
    "2023-4-29-22",
    "2023-4-29-23",
    "2023-4-30-00",
   

 
    "2023-4-30-01",
    "2023-4-30-02",
    "2023-4-30-03",
    "2023-4-30-04",
    "2023-4-30-05",
    "2023-4-30-06",
    
  
])


const data630=ref([ "2023-6-30-00",
    "2023-6-30-01",
    "2023-6-30-02",
    "2023-6-30-03",
    "2023-6-30-04",
    "2023-6-30-05",
    "2023-6-30-06",
    "2023-6-30-07",
    "2023-6-30-08",
    "2023-6-30-09",
    "2023-6-30-10",
    "2023-6-30-11",
    "2023-6-30-12",
    "2023-6-30-13",
    "2023-6-30-14",
    "2023-6-30-15",
    "2023-6-30-16",
    "2023-6-30-17",
    "2023-6-30-18",
    "2023-6-30-19",
    "2023-6-30-20",
    "2023-6-30-21",
    "2023-6-30-22",
    "2023-6-30-23",
    "2023-7-1-00",
])
const data76=ref([ 
    "2023-7-6-09",
    "2023-7-6-10",
    "2023-7-6-11",
    "2023-7-6-12",
    "2023-7-6-13",
    "2023-7-6-14",
    "2023-7-6-15",
    "2023-7-6-16",
    "2023-7-6-17",
    "2023-7-6-18",
    "2023-7-6-19",
    "2023-7-6-20",
    "2023-7-6-21",
    "2023-7-6-22",
    "2023-7-6-23",
    "2023-7-7-00",
  
    "2023-7-7-01",
    "2023-7-7-02",
    "2023-7-7-03",
    "2023-7-7-04",
    "2023-7-7-05",
    "2023-7-7-06",
    "2023-7-7-07",
    "2023-7-7-08",
    "2023-7-7-09",
    "2023-7-7-10",
    "2023-7-7-11",
    "2023-7-7-12",
    "2023-7-7-13",
    "2023-7-7-14",
    "2023-7-7-15",
    "2023-7-7-16",
    "2023-7-7-17",
    "2023-7-7-18",
    "2023-7-7-19",
    "2023-7-7-20",
    "2023-7-7-21",
    "2023-7-7-22",
    "2023-7-7-23",
    
])
const guanceshuzu412=ref([])
const monishuzu412=ref([80.05335,
79.51245427,
78.832235546,
78.143812049,
77.458689561,
76.815441666,
76.761014556,
78.577006042,
100.92579147,
245.196060859,
510.397282462,
568.520021015,
554.837782939,
531.02870099,
468.044883552,
417.222972944,
339.655414504,
304.167130924,
266.799156003,
254.928213675,
246.191028227,
218.530890546,
212.301067014,
206.411647023,
189.456461033,
173.307186084,
166.571297691,
150.84752982,
146.091508542,
140.511877562,
134.216143617,
130.148431278,
123.332816414,
120.953635874,
119.279836228,
])
const guanceshuzu429=ref([])
const monishuzu429=ref([80.05335,
79.51245427,
78.832235546,
78.143812049,
77.458689561,
76.815441666,
76.502046231,
76.789622934,
80.176586465,
109.794164161,
169.717886897,
200.660757811,
208.353878256,
209.883455048,
203.795114858,
192.607471288,
174.174206614,
161.300622794,
150.231418902,
143.709610576,
139.498720852,
132.522320178,
128.677553742,
126.160398839,
122.094464081,
117.343778453,
114.252826585,
110.272266232,
107.631889105,
105.360016641,
103.098984965,
])
const guanceshuzu630=ref([
47.9921,
49.10512,
58.58,
54.89,
50.1,
46.6,
43.55,
44.56,
99.4,
120.3,
565.4,
1073,
1261,
880,
631,
471,
392,
385,
319,
277,
301.8,
197,
233.45,
204.4,
187.5,

],)
const monishuzu630=ref([
60.06525,
59.708633758,
59.218967997,
58.726554085,
58.237046752,
57.77481632,
59.253314246,
65.776328572,
36.056161207,
190.371027776,
571.087939042,
1043.221359556,
1449.583628953,
896.162717649,
793.693873891,
710.237674038,
566.721610506,
538.220312698,
518.505897704,
462.740504392,
428.947844119,
408.148709674,
344.754088886,
277.598254586,
233.247445984,


],)
const guanceshuzu76=ref([
286.88795,
284.8899,
294.61185,
282.1122,
249.16865,
229.1136,
205.892,
184.83695,
171.72615,
153.4488,
137.94915,
126.61605,
123.61605,
134.50455,
221.7798,
392.2195,
578.15885,
861.92885,
1188.86295,
1230.75355,
1134.85045,
1184.89575,
1187.6543,
1013.49475,
770.72405,
595.7833,
528.1171,
336.61535,
377.3359,
372.5582,
344.39165,
324.23625,
314.18085,
315.43625,
318.89165,
306.9697,
303.8697,
230.98555,
168.55385,


],)
const monishuzu76=ref([
196.88795,
194.8899,
204.61185,
192.1122,
159.16865,
139.1136,
115.892,
131.355228296,
133.062846264,
134.792663265,
136.544967888,
141.050951828,
142.884614202,
159.630787765,
341.953848553,
513.81574558,
731.115848192,
865.658324401,
1003.324787767,
1155.236604026,
1160.755186144,
1170.333290386,
1107.815410487,
997.41151703,
911.115608988,
861.015183108,
783.089077021,
740.844421905,
688.579031977,
620.42362667,
604.482758514,
550.544179265,
484.713558396,
444.480416879,
412.256618569,
391.998832291,
372.102720638,
235.199299375,
223.261632383,

],)

onMounted(() => {

//  console.log(simuStore.simuData.start.format(
//           "YYYY-MM-DD"
//         )) 
    if(simuStore.simuData.start.format(
          "YYYY-MM-DD"
        )=="2023-06-30"){
      option.value.xAxis.data=data630
     /*  option.value.series[1].data=guanceshuzu630 */
      option.value.series[0].data=monishuzu630

    }
    else if(simuStore.simuData.start.format(
          "YYYY-MM-DD"
        )=="2023-04-29"){
    option.value.xAxis.data=data429
    /*   option.value.series[1].data=guanceshuzu429 */
      option.value.series[0].data=monishuzu429

    }
        else if(simuStore.simuData.start.format(
          "YYYY-MM-DD"
        )=="2023-04-12"){
    option.value.xAxis.data=data412
     /*  option.value.series[1].data=guanceshuzu412 */
      option.value.series[0].data=monishuzu412

    }
    else{
      option.value.xAxis.data=data76
   /*    option.value.series[1].data=guanceshuzu76 */
      option.value.series[0].data=monishuzu76
    }
});

</script>
<template>

<v-chart class="chart content-item" :option="option" ></v-chart>

</template>
<style scoped>

/* .title1 {
  position: absolute;
  width: 500px;
  height: 400px;
  z-index: 1000;
  top:100px;
  left: 500px;
} */
.content-item {

  overflow: auto;
  position: absolute;
  width: 500px;
  height: 350px;
  z-index: 1000;
  top: 50px;
right:  00px;
}
/* .content-item2 {
  width: 500px;
  height: 350px;
  overflow: auto;
  position: absolute;
  width: 500px;
  height: 400px;
  z-index: 1000;
  top:500px;
  left: 500px;
} */
/* .chart1{
  width: 100px;
  height: 100px;
  color: black;
} */
</style>

